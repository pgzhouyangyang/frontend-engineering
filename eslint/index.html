<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>代码规范 | 前端工程化</title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/frontend-engineering/assets/style.c62ae67b.css">
    <link rel="modulepreload" href="/frontend-engineering/assets/app.72e1d3fb.js">
    <link rel="modulepreload" href="/frontend-engineering/assets/eslint_index.md.efc513d0.lean.js">
    
    <meta name="twitter:title" content="代码规范 | 前端工程化">
  <meta property="og:title" content="代码规范 | 前端工程化">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-2ba227d5><div class="sidebar-button" data-v-2ba227d5><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/frontend-engineering/" aria-label="前端工程化, back to home" data-v-2ba227d5 data-v-b3da5816><!----> 前端工程化</a><div class="flex-grow" data-v-2ba227d5></div><div class="nav" data-v-2ba227d5><nav class="nav-links" data-v-2ba227d5 data-v-0fce24fe><!--[--><div class="item" data-v-0fce24fe><div class="nav-link" data-v-0fce24fe data-v-2cb643ba><a class="item isExternal" href="http://192.168.0.20:8929/zhouyangyang/frontend-engineering" target="_blank" rel="noopener noreferrer" data-v-2cb643ba>gitlab <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-2cb643ba><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-79af364c><nav class="nav-links nav" data-v-79af364c data-v-0fce24fe><!--[--><div class="item" data-v-0fce24fe><div class="nav-link" data-v-0fce24fe data-v-2cb643ba><a class="item isExternal" href="http://192.168.0.20:8929/zhouyangyang/frontend-engineering" target="_blank" rel="noopener noreferrer" data-v-2cb643ba>gitlab <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-2cb643ba><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-79af364c><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend-engineering/">介绍</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend-engineering/choosing-technology/index.html">技术选型</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/frontend-engineering/eslint/index.html">规范</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#代码规范">代码规范</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#eslint-与约束">ESLint 与约束</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#eslint-config">eslint-config</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#第一层约束-ide">第一层约束: IDE</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#第二层约束-git-hooks">第二层约束: Git Hooks</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#第三层约束-ci">第三层约束: CI</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#git-规范">git 规范</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#分支管理规范">分支管理规范</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#git-commit-规范">git commit 规范</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#type-commit-的类型">type: commit 的类型</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#示例">示例</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#小结">小结</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend-engineering/performance/index.html">性能优化</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend-engineering/test/index.html">测试</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend-engineering/deploy/index.html">部署</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend-engineering/monitoring/index.html">监控</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/frontend-engineering/refactor/index.html">重构</a><!----></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-30e7de44><div class="container" data-v-30e7de44><!--[--><!--]--><div style="position:relative;" class="content" data-v-30e7de44><div><h2 id="代码规范" tabindex="-1">代码规范 <a class="header-anchor" href="#代码规范" aria-hidden="true">#</a></h2><p>一个团队应使用一致的代码风格，统一代码规范的好处：</p><p>规范的代码可以促进团队合作 规范的代码可以降低维护成本 规范的代码有助于 code review（代码审查） 养成代码规范的习惯，有助于程序员自身的成长</p><p>当团队的成员都严格按照代码规范来写代码时，可以保证每个人的代码看起来都像是一个人写的，看别人的代码就像是在看自己的代码。更重要的是我们能够认识到规范的重要性，并坚持规范的开发习惯。</p><h3 id="eslint-与约束" tabindex="-1">ESLint 与约束 <a class="header-anchor" href="#eslint-与约束" aria-hidden="true">#</a></h3><p>统一编码规范不仅可以大幅提高代码可读性，甚至会提高代码质量。当我们设计了一套关于编码规范的规则集时，需要工具去辅助检测，这就是 ESLint。</p><div class="language-js"><pre><code>npm install eslint <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre></div><p>规则集需要统一集中配置，ESLint 会默认读取配置文件 .eslintrc.js 来解析，而规则集在 rules 中进行配置：</p><div class="language-js"><pre><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;parserOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;ecmaVersion&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;sourceType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;ecmaFeatures&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;jsx&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;semi&quot;</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
         <span class="token string-property property">&quot;linebreak-style&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token punctuation">,</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;windows&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>而我们需要做的是设定我们的代码规范，即 rules 项，关于它的文档及最佳实践参考下文：</p><p><a href="https://eslint.org/docs/rules/">ESLint Rules and Best Practices</a></p><h3 id="eslint-config" tabindex="-1">eslint-config <a class="header-anchor" href="#eslint-config" aria-hidden="true">#</a></h3><p>我们没有必要设计约束规制，既耗费人力，又难以做到规则的全部覆盖。</p><p>很多优秀的团队，都根据最佳实践设定了特别优秀的编码规范，比如 <code>airbnb</code> 设定了一套约束特别强的规范。</p><ul><li><a href="https://github.com/airbnb/javascript" target="_blank" rel="noopener noreferrer">airbnb javascript style</a></li></ul><div class="language-js"><pre><code>npm install eslint<span class="token operator">-</span>config<span class="token operator">-</span>airbnb<span class="token operator">-</span>base eslint<span class="token operator">-</span>plugin<span class="token operator">-</span><span class="token keyword">import</span> <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre></div><p>另外也有一些特别简单但却十分实用的规范，如 <code>eslint:recommended</code>。</p><p>我们仅仅需要<strong>使用 <code>extend</code> 配置项去继承一些优秀的开源的代码规范，并使用 <code>rules</code> 做一些自己团队的规则补充</strong></p><p>当配置 <code>.eslintrc.js</code> 时，使用 <code>config.extends</code> 将会继承已有的 <code>.eslintrc.js</code> 配置文件，配置时可省略 <code>eslint-config-</code> 前缀 (与 babel 相似)。</p><p>如使用 <code>airbnb-base</code>，我们将基于 <code>eslint-config-airbnb-base</code> 这份 eslint 配置文件，再补充自己团队的 rules 进行适配。</p><div class="language-json"><pre><code> module.exports = <span class="token punctuation">{</span>
   
   + extends<span class="token operator">:</span> <span class="token punctuation">[</span>&#39;airbnb-base&#39;<span class="token punctuation">]</span>
    
<span class="token punctuation">}</span>;
</code></pre></div><h3 id="第一层约束-ide" tabindex="-1">第一层约束: IDE <a class="header-anchor" href="#第一层约束-ide" aria-hidden="true">#</a></h3><p>当不符合代码规范的第一时间，我们就要感知到它，及时反馈，快速纠正，比直到最后积攒了一大堆错误要高效很多。</p><p>这里以 <code>VS Code</code> 作为示例，它只需要安装一个插件：<code>eslint</code>，便可以做到智能提示</p><h3 id="第二层约束-git-hooks" tabindex="-1">第二层约束: Git Hooks <a class="header-anchor" href="#第二层约束-git-hooks" aria-hidden="true">#</a></h3><p>团队合作中的编码规范有一点是，虽然自己有可能不舒服，但是不能让别人因为自己的代码而不舒服。</p><p>git 自身包含许多 hooks，在 <code>commit</code>，<code>push</code> 等 git 事件前后触发执行。与 <code>pre-commit hook</code> 结合可以帮助校验 Lint，如果非通过代码规范则不允许提交。</p><p><a href="https://github.com/typicode/husky" target="_blank" rel="noopener noreferrer">husky</a> 是一个使 <code>git hooks</code> 变得更简单的工具，只需要配置几行 <code>package.json</code> 就可以愉快的开始工作。</p><div class="language-"><pre><code>npm install -D husky lint-staged

npx husky install

npx husky add ./.husky/pre-commit &quot;npx lint-staged&quot;
</code></pre></div><div class="language-json"><pre><code><span class="token comment">// package.json</span>
``` json
<span class="token punctuation">{</span>
  <span class="token property">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;*.js&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>不过做前端的都明白，客户端校验是不可信的，通过一条命令即可绕过 <code>git hooks</code>。</p><div class="language-bash"><pre><code>$ <span class="token function">git</span> commit -n
</code></pre></div><h3 id="第三层约束-ci" tabindex="-1">第三层约束: CI <a class="header-anchor" href="#第三层约束-ci" aria-hidden="true">#</a></h3><p><code>git hooks</code> 可以绕过，但 CI(持续集成) 是绝对绕不过的，因为它在服务端校验。使用 <code>gitlab CI</code> 做持续集成，配置文件 <code>.gitlab-ci.yaml</code> 如下所示</p><div class="language-yaml"><pre><code><span class="token key atrule">lint</span><span class="token punctuation">:</span>
  <span class="token key atrule">stage</span><span class="token punctuation">:</span> lint
  <span class="token key atrule">only</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> /^feature\/.<span class="token important">*$/</span>
  <span class="token key atrule">script</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> npm run lint
</code></pre></div><h2 id="git-规范" tabindex="-1">git 规范 <a class="header-anchor" href="#git-规范" aria-hidden="true">#</a></h2><p>git 规范包括两点：分支管理规范、git commit 规范。</p><h3 id="分支管理规范" tabindex="-1">分支管理规范 <a class="header-anchor" href="#分支管理规范" aria-hidden="true">#</a></h3><ul><li>一般项目分主分支（master）和其他分支。</li><li>当有团队成员要开发新功能或改 BUG 时，就从 master 分支开一个新的分支。例如项目要从客户端渲染改成服务端渲染，就开一个分支叫 ssr，开发完了再合并回 master 分支。</li><li>如果改一个 BUG，也可以从 master 分支开一个新分支，并用 BUG 号命名。</li></ul><h3 id="git-commit-规范" tabindex="-1">git commit 规范 <a class="header-anchor" href="#git-commit-规范" aria-hidden="true">#</a></h3><div class="language-"><pre><code>&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;
&lt;BLANK LINE&gt;
&lt;body&gt;
&lt;BLANK LINE&gt;
&lt;footer&gt;
</code></pre></div><p>大致分为三个部分(使用空行分割):</p><ul><li>标题行: 必填, 描述主要修改类型和内容</li><li>主题内容: 描述为什么修改, 做了什么样的修改, 以及开发的思路等等</li><li>页脚注释: 可以写注释，BUG 号链接</li><li>type: commit 的类型</li></ul><h3 id="type-commit-的类型" tabindex="-1">type: commit 的类型 <a class="header-anchor" href="#type-commit-的类型" aria-hidden="true">#</a></h3><ul><li>feat: 新功能、新特性</li><li>fix: 修改 bug</li><li>perf: 更改代码，以提高性能</li><li>refactor: 代码重构（重构，在不影响代码内部行为、功能下的代码修改）</li><li>docs: 文档修改</li><li>style: 代码格式修改, 注意不是 css 修改（例如分号修改）</li><li>test: 测试用例新增、修改</li><li>build: 影响项目构建或依赖项修改</li><li>revert: 恢复上一次提交</li><li>ci: 持续集成相关文件修改</li><li>chore: 其他修改（不在上述类型中的修改）</li><li>release: 发布新版本</li><li>workflow: 工作流相关文件修改</li></ul><ol><li>scope: commit 影响的范围, 比如: route, component, utils, build...</li><li>subject: commit 的概述</li><li>body: commit 具体修改内容, 可以分为多行.</li><li>footer: 一些备注, 通常是 BREAKING CHANGE 或修复的 bug 的链接.</li></ol><h3 id="示例" tabindex="-1">示例 <a class="header-anchor" href="#示例" aria-hidden="true">#</a></h3><p><strong>fix（修复BUG）</strong></p><p>如果修复的这个BUG只影响当前修改的文件，可不加范围。如果影响的范围比较大，要加上范围描述。 例如这次 BUG 修复影响到全局，可以加个 global。如果影响的是某个目录或某个功能，可以加上该目录的路径，或者对应的功能名称。</p><div class="language-"><pre><code>// 示例1
fix(global):修复checkbox不能复选的问题
// 示例2 下面圆括号里的 common 为通用管理的名称
fix(common): 修复字体过小的BUG，将通用管理下所有页面的默认字体大小修改为 14px
// 示例3
fix: value.length -&gt; values.length
</code></pre></div><p><strong>feat（添加新功能或新页面）</strong></p><div class="language-"><pre><code>feat: 添加网站主页静态页面

这是一个示例，假设对点检任务静态页面进行了一些描述。
 
这里是备注，可以是放BUG链接或者一些重要性的东西。
</code></pre></div><h2 id="小结" tabindex="-1">小结 <a class="header-anchor" href="#小结" aria-hidden="true">#</a></h2><ol><li>团队中代码规范统一是极有必要的</li><li>使用成熟的 eslint config，并做细节修改</li><li>设置部分 eslint rule 为警告，保障开发体验，并且在 <code>pre-commit</code> 与 <code>CI</code> 中把警告视为不通过，保证严格的代码规范</li><li>可以在 <code>IDE (vscode)</code>，<code>git hooks</code>，<code>CI</code> 中添加三层规范校验拦截</li><li>可以使用 <code>husky</code> 与 <code>lint-staged</code> 很方便地做关于 lint 的 <code>git hooks</code></li><li><code>git hooks</code> 的规范校验可以通过 <code>git commit -n</code> 跳过，需要在 CI 层继续加强校验</li></ol></div></div><footer class="page-footer" data-v-30e7de44 data-v-504b1bfc><div class="edit" data-v-504b1bfc><div class="edit-link" data-v-504b1bfc data-v-40c300d5><!----></div></div><div class="updated" data-v-504b1bfc><!----></div></footer><div class="next-and-prev-link" data-v-30e7de44 data-v-0f10f042><div class="container" data-v-0f10f042><div class="prev" data-v-0f10f042><a class="link" href="/frontend-engineering/choosing-technology/" data-v-0f10f042><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-0f10f042><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-0f10f042>技术选型</span></a></div><div class="next" data-v-0f10f042><a class="link" href="/frontend-engineering/performance/" data-v-0f10f042><span class="text" data-v-0f10f042>性能优化</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-0f10f042><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"choosing-technology_index.md\":\"8fbb883d\",\"deploy_index.md\":\"f9dfa521\",\"eslint_index.md\":\"efc513d0\",\"index.md\":\"537c606f\",\"monitoring_index.md\":\"27fbd7c3\",\"performance_index.md\":\"a4548376\",\"refactor_index.md\":\"c2df36e4\",\"test_index.md\":\"97582ecf\"}")</script>
    <script type="module" async src="/frontend-engineering/assets/app.72e1d3fb.js"></script>
    
  </body>
</html>